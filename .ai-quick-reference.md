# AI Context Quick Reference Card - Sangeetha Grantha Platform

## ğŸš€ Quick Start

| AI Tool | Context File | How to Use |
|---------|-------------|------------|
| **ChatGPT** | `.chatgpt-config.md` | "Read .chatgpt-config.md and help me..." |
| **Cursor** | `.cursorrules` | Auto-loaded, use Cmd/Ctrl+K |
| **Claude** | `.claude-context.md` | "Using .claude-context.md, please..." |
| **Gemini** | `.gemini-context.md` | "Reference .gemini-context.md to..." |
| **Aider** | `.aiderignore` | Auto-respected, run `aider` |
| **Antigravity** | `.antigravity.md` | "Read .antigravity.md and help me..." |

## ğŸ¯ Key Facts

### Tech Stack & Versions
For current toolchain and library versions, see **[Current Versions](application_documentation/00-meta/current-versions.md)**.

### Module Structure
```
modules/
â”œâ”€â”€ shared/domain/           # Common DTOs (KMP)
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ api/                 # Ktor routes
â”‚   â””â”€â”€ dal/                 # Exposed ORM
â””â”€â”€ frontend/
    â””â”€â”€ sangita-admin-web/     # React TS (ACTIVE)
```

### Database
- **Tool**: Rust CLI (`tools/sangita-cli/`)
- **NOT**: Flyway âŒ
- **Run**: `cargo run -- db migrate`

## âš ï¸ Critical Rules

### Backend (Kotlin)
```kotlin
// âœ… DO: Use DatabaseFactory.dbQuery
suspend fun getKrithi(id: UUID) = DatabaseFactory.dbQuery {
    KrithisTable.selectAll().where { id eq id }
}

// âœ… DO: Return DTOs
data class KrithiDto(val id: UUID, val title: String)

// âœ… DO: Log mutations
dal.auditLogs.append { /* log */ }

// âŒ DON'T: Skip dbQuery
// âŒ DON'T: Return Exposed entities
// âŒ DON'T: Skip audit logs
```

### Frontend (TypeScript)
```typescript
// âœ… DO: Explicit types
interface Props { krithi: KrithiDto; }

// âœ… DO: Tailwind classes
<div className="rounded-lg border p-4">

// âœ… DO: Functional components with hooks
export const KrithiCard: React.FC<Props> = ({ krithi }) => {

// âŒ DON'T: Use any
// âŒ DON'T: Skip prop types
```

## ğŸ“‹ Common Commands

```bash
# Full Stack Dev
cargo run -- dev --start-db (from tools/sangita-cli)

# DB Reset
cargo run -- db reset (from tools/sangita-cli)

# Test
cargo run -- test steel-thread
```

## ğŸš« Never Do

1. âŒ Suggest Flyway (use Rust migrations)
3. âŒ Use `any` in TypeScript
4. âŒ Skip `DatabaseFactory.dbQuery`
5. âŒ Return Exposed entities
6. âŒ Add deps without version catalog

## âœ… Always Do

1. âœ… Use `DatabaseFactory.dbQuery { }`
2. âœ… Log to `audit_log`
3. âœ… Return DTOs
4. âœ… Reference `gradle/libs.versions.toml`
5. âœ… Use TypeScript strict mode
6. âœ… Use Tailwind utilities

## ğŸ“š Documentation

| Need | See |
|------|-----|
| Backend patterns | `application_documentation/02-architecture/backend-system-design.md` |
| Tech stack | `application_documentation/02-architecture/tech-stack.md` |
| API contracts | `application_documentation/03-api/api-contract.md` |
| Database schema | `application_documentation/04-database/schema.md` |
| Getting Started | `application_documentation/00-onboarding/getting-started.md` |

## ğŸ” Troubleshooting

| Problem | Solution |
|---------|----------|
| AI suggests Flyway | "This project uses Rust migrations only" |
| AI uses `any` | "Use TypeScript strict mode, no any" |
| AI skips dbQuery | "All DB ops must use DatabaseFactory.dbQuery" |

## ğŸ’¡ Pro Tips

1. **Start conversations** by referencing the context file
2. **Be specific** about which patterns to follow
3. **Test locally** before asking AI to commit
4. **Check versions** in `gradle/libs.versions.toml`
5. **Read docs** in `application_documentation/`

## ğŸ¨ Code Patterns

### Ktor Route
```kotlin
fun Route.krithiRoutes(service: IKrithiService) {
    authenticate("jwt") {
        get("/v1/admin/krithis") {
            call.respond(service.search(request))
        }
    }
}
```

### React Component
```typescript
interface KrithiCardProps {
  krithi: KrithiDto;
  onEdit?: (id: string) => void;
}

export const KrithiCard: React.FC<KrithiCardProps> = 
  ({ krithi, onEdit }) => (
    <div className="rounded-lg border p-4">
      <h3 className="font-semibold">{krithi.title}</h3>
      {onEdit && <button onClick={() => onEdit(krithi.id)}>Edit</button>}
    </div>
  );
```

---

**Print this card** or keep it handy when working with AI assistants!